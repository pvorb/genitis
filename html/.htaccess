#### For detail information on mod_rewrite see http://httpd.apache.org/docs/2.2/mod/mod_rewrite.html ####

RewriteEngine		On
RewriteBase			/

RewriteCond			%{HTTP_HOST}	^(www\.)?ip\.genitis\.org
RewriteRule			^(.*)$			/project/ip/

RewriteCond			%{HTTP_HOST}	^genitis\.org$					[NC,OR]
RewriteCond			%{HTTP_HOST}	^(www\.)?paulvorbach\.de$		[NC]
RewriteRule			^(.*)$			http://www.genitis.org/$1		[L,R=301]

##################################
# Handle Directories
##################################

# Map /dir -> /dir/ if /dir/ is a directory.
RewriteCond			%{REQUEST_FILENAME}/	-d
RewriteCond			%{REQUEST_URI}			!(.*)/$
RewriteRule			^(.*)$					/$1/					[L,R=301]

# Internally map to /index.php?dir=*
RewriteCond			%{REQUEST_FILENAME}		-d
RewriteCond			%{REQUEST_URI}			(.*)/$
RewriteRule			^(.*)$					/index.php?dir=$1		[L,QSA,NC]

##################################
# Handle HTML files
##################################

# Map file.html -> file
RewriteRule			^(.*)\.html$			/$1						[L,R=301]

# Map path/index -> path/ //Remove index, because it is unnessecary.
RewriteRule			^((.*/)*)index$			/$1						[L,R=301]

# Map file/ -> file
RewriteCond			%{REQUEST_FILENAME}		!-d
RewriteRule			^(.*)/$					/$1						[L,R=301]

# Internally map to /index.php?file=*
RewriteCond			%{REQUEST_FILENAME}.html	-f
RewriteCond			%{REQUEST_URI}			!(.*)/$
RewriteRule			^(.*)$					/index.php?file=$1		[L,QSA,NC]

# Map bad requests to /error/404?s=*
RewriteCond			%{REQUEST_FILENAME}		!-d
RewriteCond			%{REQUEST_FILENAME}/	!-d
RewriteCond			%{REQUEST_FILENAME}		!-f
RewriteCond			%{REQUEST_FILENAME}.html	!-f
RewriteRule			^(.*)$					/error/404?s=$1			[L,R=307]

